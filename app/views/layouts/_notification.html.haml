/ YJB: This partial is a huge, steaming, pile of poo.
/      Of course the ajax behavior is hard to debug. Get all that logic out of here.
/ YJB: This stuff belongs in the model. Why not program in english?
/      if current_user.has_notifications?
/ YJB: Lastly, I see the concept of "notifications" everywhere in your code, but is there a Notice or Notification model?
/      This is a strong sign that you are not programming to the domain, solving webapp problems instead of business problems.
- if get_notifications_count(current_user) > 0
  /  - unless current_user.household_confirmed.eql? false
  /    YJB: That line above is like saying I don't don't want a beer.
  - if current_user.household_confirmed
    %li#notifications
      = link_to_remote image_tag('/images/notification_icon.png'), :update => "notifications", :url => {:controller => 'notifications', :action => 'update_read'}
      .notification-list
        / - for notification in get_notifications(current_user)
        / YJB: Oh my gawd that line above is like rolling the bottom of your jeans up.
        - get_notifications(current_user).each do |notification|
          .notification
            / - if notification.class.name == 'Neighbor'
            / YJB: Use ruby. Better yet, use case/switch. And of course, this logic doesn't belong here.
            - if notification.is_a? Neighbor
              #left
                = link_to image_tag (notification.neighbor.photo.url(:tiny)), members_neighbors_path
              #right
                %span= link_to "The #{notification.neighbor} household has accepted your neighbor request", members_neighbors_path
              #clear
            - elsif notification.is_a? PendingRequest # YJB
              - @request_household = get_household(notification.belongs_to_household_id) # YJB: belongs_to_household_id? This is very unconventional, surely there's a better way to model this.
              #left
                = link_to image_tag (@request_household.photo.url(:tiny)), members_requests_path
              #right
                %span= link_to "The #{@request_household} household has picked you to watch their children on #{notification.request.from_date.to_s(:dateNoYear)}.", members_requests_path
              #clear
            - elsif notification.is_a? User # YJB
              -# @request_household = get_household(notification.belongs_to_household_id)
              #left
                -#= link_to image_tag (@request_household.photo.url(:tiny)), members_requests_path
              #right
                -@user = get_user(notification.id)
                %span= link_to "#{@user} has requested to become a caregiver in your household", members_users_path
              #clear
      %li#notification-modified= get_notifications_count(current_user)
- else
  %li#notifications
    = link_to image_tag('/images/notification_icon_grey.png'), '#', :title => 'Notifications'
